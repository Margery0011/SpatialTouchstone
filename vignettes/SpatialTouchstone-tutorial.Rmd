---
title: "Introduction to SpatialTouchstone"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to SpatialTouchstone}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
pkgdown:
  as_is: true
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


```{r setup}
library(SpatiaTouchstone)
```

## Read Data 

Here, I am using An Xenium data as an example, using `readSpatial` function. 

```{r expMat}
expMat ="/mnt/scratch1/Touchstone_data/new_data/TOUCHSTONE_EAP_XRS_FFPE_PR_3_UOA_C_R1/cell_feature_matrix"
```

```{r read data }
# Do not return a seurat object 
result <- readSpatial(sample_id = "test1",path="/mnt/scratch1/Touchstone_data/new_data/TOUCHSTONE_EAP_XRS_FFPE_PR_3_UOA_C_R1/",platform = "Xenium",seurat = FALSE)
head(result)
```

It can return a `Seurat` Object by seting the `seurat=TRUE`.

```{r read data as a seurat object,warning=FALSE}
# Return a seurat object 
result_seu <- readSpatial(sample_id = "test1",path="/mnt/scratch1/Touchstone_data/new_data/TOUCHSTONE_EAP_XRS_FFPE_PR_3_UOA_C_R1/",platform = "Xenium",seurat = TRUE)
print(result_seu)
```
## QC 

We have mutliple QC functions, when using seurat object as the input, it will return a dataframe which can be used to generate plot using our plot functions.


```{r getTxPerCell1}
getTxPerCell_seu<- getTxPerCell(expMat="/mnt/scratch1/Touchstone_data/new_data/TOUCHSTONE_EAP_XRS_FFPE_PR_3_UOA_C_R1/cell_feature_matrix/",platform = "Xenium",seu_obj = result_seu)
getTxPerCell_seu
```

```{r getTxPerArea}
getTxPerArea_test_seu <- getTxPerArea(platform = "Xenium",seu_obj = result_seu)
getTxPerArea_test_seu
```
```{r getNcells}
getNcells_test_seu <- getNcells(expMat=expMat,platform = "Xenium",seu_obj = result_seu)
getNcells_test_seu 
```

```{r getGlobalFDR}
# getGlobalFDR_test_seu<- getGlobalFDR(tx_file = "/mnt/scratch1/Touchstone_data/new_data/TOUCHSTONE_EAP_XRS_FFPE_PR_3_UOA_C_R1/transcripts.csv.gz",platform = "Xenium",seu_obj = result_seu)
# getGlobalFDR_test_seu
```
###  Notes: 

getGlobalFDR: Need to be modified as a dataframe (getGlobalFDR_test_seu for input as seurat object )



```{r getTxPerCell2}
getTxPerCell_test_seu<- getTxPerCell(platform = "Xenium",seu_obj = result_seu)
getTxPerCell_test_seu
```



